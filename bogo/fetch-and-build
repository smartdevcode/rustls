#!/bin/sh

set -e

wget https://boringssl.googlesource.com/boringssl/+archive/master/ssl/test/runner.tar.gz
mkdir -p bogo
tar -C bogo/ -xzf runner.tar.gz
( cd bogo/ && go test -c )

# generate new key and cert, because the one provided is expired :(
( cd bogo/ &&
  openssl req -newkey rsa:2048 -x509 -batch -nodes -keyout key.pem -out cert.pem -days 3650 &&
  openssl rsa -in key.pem -out key.rsa )
